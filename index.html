<!doctype html>
<html lang="ja">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>困ったときの言い訳メーカー</title>
  <style>
    body { font-family: system-ui, -apple-system, "Segoe UI", sans-serif; margin: 0; background:#f7f7f7; }
    .wrap { max-width: 720px; margin: 0 auto; padding: 16px; }
    .card { background:#fff; border-radius: 14px; padding: 16px; box-shadow: 0 6px 18px rgba(0,0,0,.06); }
    h1 { font-size: 18px; margin: 0 0 6px; }
    .sub { color:#666; font-size: 12px; margin-bottom: 14px; }
    .row { display:flex; gap:10px; flex-wrap:wrap; }
    select { flex:1; min-width: 160px; padding: 10px; border-radius: 10px; border:1px solid #ddd; background:#fff; }
    textarea { width:100%; height: 140px; padding: 12px; border-radius: 12px; border:1px solid #ddd; resize:none; font-size: 14px; line-height: 1.6; }
    .btns { display:flex; gap:10px; margin-top: 10px; flex-wrap:wrap; }
    button { padding: 10px 12px; border:0; border-radius: 12px; background:#111; color:#fff; cursor:pointer; }
    button.secondary { background:#e9e9e9; color:#111; }
    .ad { margin-top: 14px; padding: 14px; border-radius: 12px; background:#fafafa; border:1px dashed #ddd; color:#777; font-size:12px; text-align:center; }
    .foot { margin-top: 14px; color:#777; font-size: 11px; line-height:1.6; }
  </style>
</head>
<body>
  <div class="wrap">
    <div class="card">
      <h1>困ったときの言い訳メーカー</h1>
      <div class="sub">カテゴリと用途を選ぶだけ。文章が自動で出ます（ログイン不要）</div>

      <div class="row">
        <select id="category"></select>
        <select id="purpose"></select>
      </div>

      <div style="margin-top:12px;">
        <textarea id="output" readonly></textarea>
        <div class="btns">
          <button id="copy">コピー</button>
          <button id="reload" class="secondary">別案を出す</button>
        </div>
      </div>

      <div class="ad">広告枠（ここにAdSense等）</div>

      <div class="foot">
        ※本サービスは文章例を提供するもので、利用結果について責任を負いません。<br/>
        露骨な虚偽や違法行為を助長する用途には使用しないでください。
      </div>
    </div>
  </div>

<script>
/**
 * ==========================
 * ✅ 追記専用ゾーン（ここだけ触る）
 * ==========================
 * 追加ルール：
 * 1) 新しいカテゴリ → DATA にカテゴリ名を追加
 * 2) 新しい用途 → そのカテゴリ内に用途名を追加
 * 3) テンプレ追加 → intro / reason / ending の配列に文章を足す
 *
 * 文の作り方（基本形）：
 *  intro + reason + ending
 *
 * 注意：
 * - 「ウソ断定」や「違法助長」っぽい文は入れない
 * - 1文は長くしすぎない（50〜120文字目安）
 */
const DATA = {
  "仕事・ビジネス": {
    "断る": {
      intro: [
        "ご連絡ありがとうございます。",
        "お声がけありがとうございます。"
      ],
      reason: [
        "現状のスケジュールの都合で、対応が難しい状況です。",
        "体制の都合上、今回はお引き受けが難しそうです。"
      ],
      ending: [
        "恐れ入りますが、見送らせてください。",
        "また別の機会がございましたら、ぜひお願いします。"
      ]
    },
    "先延ばし": {
      intro: [
        "ご連絡ありがとうございます。",
        "確認いたします。"
      ],
      reason: [
        "社内で確認している点があり、少しお時間をいただければと思います。",
        "状況を整理してから判断したく、少々お待ちください。"
      ],
      ending: [
        "進捗があり次第ご連絡します。",
        "まとまり次第、改めてご連絡いたします。"
      ]
    },
    "催促をかわす": {
      intro: [
        "ご連絡ありがとうございます。",
        "お待たせしており申し訳ありません。"
      ],
      reason: [
        "現在対応中のため、今しばらくお時間をいただけますでしょうか。",
        "優先度を調整して進めております。"
      ],
      ending: [
        "進捗があり次第ご連絡します。",
        "恐れ入りますが、もう少々お待ちください。"
      ]
    }
  },

  "プライベート": {
    "飲み会を断る": {
      intro: [
        "誘ってくれてありがとう！",
        "お誘いありがとう〜！"
      ],
      reason: [
        "最近ちょっとバタバタしてて、今回は難しそう。",
        "体調管理を優先したくて、今回は見送らせて…！"
      ],
      ending: [
        "また落ち着いたら行こう！",
        "また次回ぜひ誘って！"
      ]
    },
    "誘いを保留": {
      intro: [
        "ありがとう！",
        "了解！"
      ],
      reason: [
        "予定を確認してから返したいから、少し待ってね。",
        "今ちょっと調整中で、すぐ確定できなくて…！"
      ],
      ending: [
        "分かったらすぐ連絡する！",
        "確認できたら改めて返すね。"
      ]
    }
  },

  "お金・契約": {
    "支払いを待ってもらう": {
      intro: [
        "ご連絡ありがとうございます。",
        "お待たせしており申し訳ありません。"
      ],
      reason: [
        "現在手続き中のため、反映まで少しお時間をいただけますでしょうか。",
        "確認事項があり、処理に時間がかかっております。"
      ],
      ending: [
        "完了次第ご連絡します。",
        "恐れ入りますが、もう少々お待ちください。"
      ]
    },
    "値引きを断る": {
      intro: [
        "ご相談ありがとうございます。",
        "ご希望は承知しました。"
      ],
      reason: [
        "申し訳ありませんが、価格面は現条件が精一杯となります。",
        "現時点では条件の変更が難しい状況です。"
      ],
      ending: [
        "ご了承いただけますと幸いです。",
        "ご理解のほど、よろしくお願いいたします。"
      ]
    }
  },

  "学校・習い事": {
    "欠席連絡": {
      intro: [
        "お世話になっております。",
        "ご連絡いたします。"
      ],
      reason: [
        "体調不良のため、本日はお休みさせてください。",
        "都合により本日は欠席いたします。"
      ],
      ending: [
        "よろしくお願いいたします。",
        "次回よろしくお願いいたします。"
      ]
    },
    "提出遅れ": {
      intro: [
        "お世話になっております。",
        "ご連絡いたします。"
      ],
      reason: [
        "準備が整っておらず、提出が遅れてしまい申し訳ありません。",
        "確認に時間がかかっており、遅れております。"
      ],
      ending: [
        "でき次第提出いたします。",
        "申し訳ありませんが、よろしくお願いいたします。"
      ]
    }
  },

  "万能": {
    "時間を稼ぐ": {
      intro: [
        "ありがとうございます。",
        "承知しました。"
      ],
      reason: [
        "少し検討する時間をいただけると助かります。",
        "確認してから改めてお返事したいです。"
      ],
      ending: [
        "まとまり次第ご連絡します。",
        "少々お待ちください。"
      ]
    },
    "深掘り回避": {
      intro: [
        "ありがとうございます。",
        "すみません。"
      ],
      reason: [
        "現状では詳細をお伝えできず、ご了承ください。",
        "いまは確定していないため、決まり次第共有します。"
      ],
      ending: [
        "ご理解いただけますと幸いです。",
        "よろしくお願いします。"
      ]
    }
  }
};
/**
 * ==========================
 * ✅ 追記専用ゾーンここまで
 * ==========================
 */

const elCategory = document.getElementById("category");
const elPurpose  = document.getElementById("purpose");
const elOutput   = document.getElementById("output");
const btnReload  = document.getElementById("reload");
const btnCopy    = document.getElementById("copy");

let lastText = "";

/** ランダムで配列から1つ */
function pick(arr) {
  return arr[Math.floor(Math.random() * arr.length)];
}

/** intro+reason+ending を組み立て、同じ文章が連続しないようにする */
function buildText() {
  const cat = elCategory.value;
  const pur = elPurpose.value;
  const node = DATA?.[cat]?.[pur];

  if (!node) return "テンプレがまだありません。";

  const { intro = [], reason = [], ending = [] } = node;

  // パーツが足りない場合の安全策
  const i = intro.length  ? pick(intro)  : "";
  const r = reason.length ? pick(reason) : "";
  const e = ending.length ? pick(ending) : "";

  let text = [i, r, e].filter(Boolean).join("\n");

  // 同じ文が出たら最大5回まで作り直し
  for (let k = 0; k < 5 && text === lastText; k++) {
    const i2 = intro.length  ? pick(intro)  : i;
    const r2 = reason.length ? pick(reason) : r;
    const e2 = ending.length ? pick(ending) : e;
    text = [i2, r2, e2].filter(Boolean).join("\n");
  }

  lastText = text;
  return text;
}

function populateCategories() {
  elCategory.innerHTML = "";
  Object.keys(DATA).forEach((cat) => {
    const opt = document.createElement("option");
    opt.value = cat;
    opt.textContent = cat;
    elCategory.appendChild(opt);
  });
}

function populatePurposes() {
  const cat = elCategory.value;
  elPurpose.innerHTML = "";
  Object.keys(DATA[cat]).forEach((pur) => {
    const opt = document.createElement("option");
    opt.value = pur;
    opt.textContent = pur;
    elPurpose.appendChild(opt);
  });
}

function generate() {
  elOutput.value = buildText();
}

elCategory.addEventListener("change", () => {
  populatePurposes();
  generate();
});

elPurpose.addEventListener("change", generate);
btnReload.addEventListener("click", generate);

btnCopy.addEventListener("click", async () => {
  try {
    await navigator.clipboard.writeText(elOutput.value);
    const prev = btnCopy.textContent;
    btnCopy.textContent = "コピーしました";
    setTimeout(() => (btnCopy.textContent = prev), 900);
  } catch {
    alert("コピーに失敗しました。手動で選択してコピーしてください。");
  }
});

// 初期化
populateCategories();
populatePurposes();
generate();
</script>
</body>
</html>
