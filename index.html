<!doctype html>
<html lang="ja">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>å›°ã£ãŸã¨ãã®è¨€ã„è¨³ãƒ¡ãƒ¼ã‚«ãƒ¼</title>
  <style>
    body { font-family: system-ui, -apple-system, "Segoe UI", sans-serif; margin: 0; background:#f7f7f7; }
    .wrap { max-width: 720px; margin: 0 auto; padding: 16px; }
    .card { background:#fff; border-radius: 14px; padding: 16px; box-shadow: 0 6px 18px rgba(0,0,0,.06); }
    h1 { font-size: 18px; margin: 0 0 6px; }
    .sub { color:#666; font-size: 12px; margin-bottom: 14px; }
    .row { display:flex; gap:10px; flex-wrap:wrap; }
    select { flex:1; min-width: 160px; padding: 10px; border-radius: 10px; border:1px solid #ddd; background:#fff; }
    textarea { width:100%; height: 140px; padding: 12px; border-radius: 12px; border:1px solid #ddd; resize:none; font-size: 14px; line-height: 1.6; }
    .btns { display:flex; gap:10px; margin-top: 10px; flex-wrap:wrap; }
    button { padding: 10px 12px; border:0; border-radius: 12px; background:#111; color:#fff; cursor:pointer; }
    button.secondary { background:#e9e9e9; color:#111; }
    .ad { margin-top: 14px; padding: 14px; border-radius: 12px; background:#fafafa; border:1px dashed #ddd; color:#777; font-size:12px; text-align:center; }
    .foot { margin-top: 14px; color:#777; font-size: 11px; line-height:1.6; }
  </style>
</head>
<body>
  <div class="wrap">
    <div class="card">
      <h1>å›°ã£ãŸã¨ãã®è¨€ã„è¨³ãƒ¡ãƒ¼ã‚«ãƒ¼</h1>
      <div class="sub">ã‚«ãƒ†ã‚´ãƒªã¨ç”¨é€”ã‚’é¸ã¶ã ã‘ã€‚æ–‡ç« ãŒè‡ªå‹•ã§å‡ºã¾ã™ï¼ˆãƒ­ã‚°ã‚¤ãƒ³ä¸è¦ï¼‰</div>

      <div class="row">
        <select id="category"></select>
        <select id="purpose"></select>
      </div>

      <div style="margin-top:12px;">
        <textarea id="output" readonly></textarea>
        <div class="btns">
          <button id="copy">ã‚³ãƒ”ãƒ¼</button>
          <button id="reload" class="secondary">åˆ¥æ¡ˆã‚’å‡ºã™</button>
        </div>
      </div>

      <div class="ad">åºƒå‘Šæ ï¼ˆã“ã“ã«AdSenseç­‰ï¼‰</div>

      <div class="foot">
        â€»æœ¬ã‚µãƒ¼ãƒ“ã‚¹ã¯æ–‡ç« ä¾‹ã‚’æä¾›ã™ã‚‹ã‚‚ã®ã§ã€åˆ©ç”¨çµæœã«ã¤ã„ã¦è²¬ä»»ã‚’è² ã„ã¾ã›ã‚“ã€‚<br/>
        éœ²éª¨ãªè™šå½ã‚„é•æ³•è¡Œç‚ºã‚’åŠ©é•·ã™ã‚‹ç”¨é€”ã«ã¯ä½¿ç”¨ã—ãªã„ã§ãã ã•ã„ã€‚
      </div>
    </div>
  </div>

<script>
/**
 * ==========================
 * âœ… è¿½è¨˜å°‚ç”¨ã‚¾ãƒ¼ãƒ³ï¼ˆã“ã“ã ã‘è§¦ã‚‹ï¼‰
 * ==========================
 * æ§‹é€ ï¼šã‚«ãƒ†ã‚´ãƒª â†’ ç”¨é€” â†’ ãƒˆãƒ¼ãƒ³ â†’ intro/reason/ending
 * è¿½åŠ ãƒ«ãƒ¼ãƒ«ï¼š
 * 1) æ–°ã‚«ãƒ†ã‚´ãƒªï¼šDATAã«è¿½åŠ 
 * 2) æ–°ç”¨é€”ï¼šã‚«ãƒ†ã‚´ãƒªã®ä¸­ã«è¿½åŠ 
 * 3) æ–°ãƒˆãƒ¼ãƒ³ï¼štoneã‚­ãƒ¼ï¼ˆ"ä¸å¯§" "æ™®é€š" "ãµã–ã‘ãŸ"ï¼‰ã‚’è¿½åŠ 
 * 4) æ–‡è¿½åŠ ï¼šintro/reason/ending ã«1è¡Œè¿½åŠ 
 */
const DATA = {
  "ä»•äº‹ãƒ»ãƒ“ã‚¸ãƒã‚¹": {
    "æ–­ã‚‹": {
      "ä¸å¯§": {
        intro: ["ã”é€£çµ¡ã‚ã‚ŠãŒã¨ã†ã”ã–ã„ã¾ã™ã€‚", "ãŠå£°ãŒã‘ã‚ã‚ŠãŒã¨ã†ã”ã–ã„ã¾ã™ã€‚"],
        reason: ["ç¾çŠ¶ã®ä½“åˆ¶ã§ã¯å¯¾å¿œãŒé›£ã—ã„çŠ¶æ³ã§ã™ã€‚", "ã‚¹ã‚±ã‚¸ãƒ¥ãƒ¼ãƒ«ã®éƒ½åˆã§èª¿æ•´ãŒé›£ã—ãã†ã§ã™ã€‚"],
        ending: ["æã‚Œå…¥ã‚Šã¾ã™ãŒã€è¦‹é€ã‚‰ã›ã¦ãã ã•ã„ã€‚", "ã¾ãŸåˆ¥ã®æ©Ÿä¼šãŒã”ã–ã„ã¾ã—ãŸã‚‰ã€ã‚ˆã‚ã—ããŠé¡˜ã„ã„ãŸã—ã¾ã™ã€‚"]
      },
      "æ™®é€š": {
        intro: ["é€£çµ¡ã‚ã‚ŠãŒã¨ã†ã”ã–ã„ã¾ã™ã€‚", "å£°ã‹ã‘ã‚ã‚ŠãŒã¨ã†ï¼"],
        reason: ["ä»Šã¡ã‚‡ã£ã¨æ‰‹ãŒå›ã‚‰ãªãã¦â€¦", "äºˆå®šãŒè©°ã¾ã£ã¦ã¦é›£ã—ãã†ã€‚"],
        ending: ["ä»Šå›ã¯è¦‹é€ã‚‰ã›ã¦ï¼", "ã¾ãŸã‚¿ã‚¤ãƒŸãƒ³ã‚°åˆã†ã¨ãã«ãŠé¡˜ã„ã—ã¾ã™ï¼"]
      },
      "ãµã–ã‘ãŸ": {
        intro: ["ãŠèª˜ã„æ„Ÿè¬ã£â€¦ï¼", "å¬å–šã‚ã‚ŠãŒã¨ã†ã”ã–ã„ã¾ã™ï¼"],
        reason: ["ä»Šã®ç§ã€ã‚¿ã‚¹ã‚¯ã«åŒ…å›²ã•ã‚Œã¦ãŠã‚Šã¾ã™ã€‚", "ã‚¹ã‚±ã‚¸ãƒ¥ãƒ¼ãƒ«ãŒæº€å“¡å¾¡ç¤¼ã§ã”ã–ã‚‹ã€‚"],
        ending: ["ä»Šå›ã¯æ’¤é€€ã—ã¾ã™ğŸ«¡", "ã¾ãŸæ¬¡ã®ã‚¯ã‚¨ã‚¹ãƒˆã§ï¼"]
      }
    },

    "å‚¬ä¿ƒã‚’ã‹ã‚ã™": {
      "ä¸å¯§": {
        intro: ["ã”é€£çµ¡ã‚ã‚ŠãŒã¨ã†ã”ã–ã„ã¾ã™ã€‚", "ãŠå¾…ãŸã›ã—ã¦ãŠã‚Šç”³ã—è¨³ã‚ã‚Šã¾ã›ã‚“ã€‚"],
        reason: ["ç¾åœ¨å¯¾å¿œä¸­ã§ã€ç¢ºèªã«å°‘ã—ãŠæ™‚é–“ã‚’ã„ãŸã ã„ã¦ãŠã‚Šã¾ã™ã€‚", "ç¤¾å†…ç¢ºèªãŒå¿…è¦ãªç‚¹ãŒã‚ã‚Šã€é€²è¡Œä¸­ã§ã™ã€‚"],
        ending: ["é€²æ—ãŒã‚ã‚Šæ¬¡ç¬¬ã”é€£çµ¡ã„ãŸã—ã¾ã™ã€‚", "æã‚Œå…¥ã‚Šã¾ã™ãŒã€ä»Šã—ã°ã‚‰ããŠå¾…ã¡ãã ã•ã„ã€‚"]
      },
      "æ™®é€š": {
        intro: ["é€£çµ¡ã‚ã‚ŠãŒã¨ã†ï¼", "ã”ã‚ã‚“ã€ç¢ºèªä¸­ï¼"],
        reason: ["ã„ã¾å¯¾å¿œã—ã¦ã‚‹ã¨ã“ã‚ã§ã™ã€‚", "ã¡ã‚‡ã„ç¢ºèªã—ãŸã„ç‚¹ãŒã‚ã£ã¦ã€‚"],
        ending: ["åˆ†ã‹ã‚Šæ¬¡ç¬¬ã™ãè¿”ã™ã­ã€‚", "ã‚‚ã†å°‘ã—å¾…ã£ã¦ã‚‚ã‚‰ãˆã‚‹ã¨åŠ©ã‹ã‚‹ï¼"]
      },
      "ãµã–ã‘ãŸ": {
        intro: ["å‚¬ä¿ƒã‚ã‚ŠãŒã¨ã†ï¼ˆå„ªã—ã‚ï¼‰ï¼", "ãƒªãƒã‚¤ãƒ³ãƒ‰åŠ©ã‹ã‚‹ï¼"],
        reason: ["ã„ã¾å…¨åŠ›ã§å‡¦ç†ä¸­ã§ã™ï¼ˆæ‰‹ãŒ8æœ¬ã»ã—ã„ï¼‰ã€‚", "é€²æ—ã€ä½œæˆä¸­â€¦ï¼…è¡¨ç¤ºãŒã‚ã‚Œã°è¦‹ã›ãŸã„ã€‚"],
        ending: ["ã‚‚ã†ã¡ã‚‡ã„ã ã‘å¾…ã£ã¦ï¼", "ç¶šå ±ã€ã®ã¡ã»ã©æŠ•ä¸‹ã—ã¾ã™ï¼"]
      }
    }
  },

  "ãƒ—ãƒ©ã‚¤ãƒ™ãƒ¼ãƒˆ": {
    "é£²ã¿ä¼šã‚’æ–­ã‚‹": {
      "ä¸å¯§": {
        intro: ["ãŠèª˜ã„ã‚ã‚ŠãŒã¨ã†ã”ã–ã„ã¾ã™ã€‚", "ãŠå£°ãŒã‘ã‚ã‚ŠãŒã¨ã†ã”ã–ã„ã¾ã™ã€‚"],
        reason: ["ä»Šå›ã¯éƒ½åˆãŒã¤ã‹ãšã€å‚åŠ ãŒé›£ã—ã„çŠ¶æ³ã§ã™ã€‚", "ä½“èª¿ç®¡ç†ã®éƒ½åˆã§ä»Šå›ã¯è¦‹é€ã‚‰ã›ã¦ãã ã•ã„ã€‚"],
        ending: ["ã¾ãŸã®æ©Ÿä¼šã«ãœã²ãŠé¡˜ã„ã„ãŸã—ã¾ã™ã€‚", "æ¬¡å›ãœã²ã”ä¸€ç·’ã•ã›ã¦ãã ã•ã„ã€‚"]
      },
      "æ™®é€š": {
        intro: ["èª˜ã£ã¦ãã‚Œã¦ã‚ã‚ŠãŒã¨ã†ï¼", "ã‚ã‚ŠãŒã¨ã†ï¼"],
        reason: ["ä»Šé€±ã¡ã‚‡ã£ã¨ãƒã‚¿ãƒã‚¿ã§â€¦", "ä»Šæ—¥ã¯æ—©ã‚ã«ä¼‘ã¿ãŸãã¦ã€‚"],
        ending: ["ä»Šå›ã¯ã”ã‚ã‚“ã­ï¼", "ã¾ãŸæ¬¡å›è¡Œã“ã†ï¼"]
      },
      "ãµã–ã‘ãŸ": {
        intro: ["ãŠèª˜ã„æ„Ÿè¬ï¼", "é£²ã¿ä¼šå¬å–šã‚ã‚ŠãŒã¨ã†ï¼"],
        reason: ["ä»Šæ—¥ã®HPãŒèµ¤ã‚²ãƒ¼ã‚¸ã§ã™ã€‚", "æœ¬æ—¥ã€å¸ƒå›£ã¨ãƒ‡ãƒ¼ãƒˆã®å…ˆç´„ãŒã‚ã‚Šã¾ã—ã¦ã€‚"],
        ending: ["ä»Šå›ã¯ä¸å‚åŠ ã§ï¼ã¾ãŸèª˜ã£ã¦ï¼", "æ¬¡å›ã¯å‚æˆ¦ã™ã‚‹ï¼ğŸ»"]
      }
    }
  },

  "ä¸‡èƒ½": {
    "æ™‚é–“ã‚’ç¨¼ã": {
      "ä¸å¯§": {
        intro: ["æ‰¿çŸ¥ã—ã¾ã—ãŸã€‚", "ã‚ã‚ŠãŒã¨ã†ã”ã–ã„ã¾ã™ã€‚"],
        reason: ["å°‘ã—æ¤œè¨ã™ã‚‹æ™‚é–“ã‚’ã„ãŸã ã‘ã¾ã™ã§ã—ã‚‡ã†ã‹ã€‚", "ç¢ºèªã®ä¸Šã€æ”¹ã‚ã¦ã”é€£çµ¡ã„ãŸã—ã¾ã™ã€‚"],
        ending: ["ã¾ã¨ã¾ã‚Šæ¬¡ç¬¬ã”é€£çµ¡ã„ãŸã—ã¾ã™ã€‚", "æã‚Œå…¥ã‚Šã¾ã™ãŒã€å°‘ã€…ãŠå¾…ã¡ãã ã•ã„ã€‚"]
      },
      "æ™®é€š": {
        intro: ["äº†è§£ï¼", "ã‚ã‚ŠãŒã¨ã†ï¼"],
        reason: ["ã¡ã‚‡ã£ã¨è€ƒãˆã¦ã‹ã‚‰è¿”ã—ãŸã„ï¼", "ç¢ºèªã—ã¦ã‹ã‚‰è¿”ã™ã­ã€‚"],
        ending: ["åˆ†ã‹ã£ãŸã‚‰é€£çµ¡ã™ã‚‹ï¼", "å°‘ã—å¾…ã£ã¦ã­ï¼"]
      },
      "ãµã–ã‘ãŸ": {
        intro: ["äº†è§£ã£ï¼", "æ‰¿çŸ¥ã®åŠ©ï¼"],
        reason: ["è„³å†…ä¼šè­°ã‚’é–‹å‚¬ã—ã¾ã™ã€‚", "æ¤œè¨ã‚¿ã‚¤ãƒ ï¼ˆã‚³ãƒ¼ãƒ’ãƒ¼ä»˜ãï¼‰å…¥ã‚Šã¾ã™ã€‚"],
        ending: ["çµè«–å‡ºãŸã‚‰é€£çµ¡ã™ã‚‹ï¼", "ç¶šå ±ã‚’å¾…ã¦ï¼"]
      }
    }
  }
};
/**
 * ==========================
 * âœ… è¿½è¨˜å°‚ç”¨ã‚¾ãƒ¼ãƒ³ã“ã“ã¾ã§
 * ==========================
 */

const elCategory = document.getElementById("category");
const elPurpose  = document.getElementById("purpose");
const elTone     = document.getElementById("tone");
const elOutput   = document.getElementById("output");
const btnReload  = document.getElementById("reload");
const btnCopy    = document.getElementById("copy");

let lastText = "";

// å®‰å…¨ï¼šå­˜åœ¨ã—ãªã„å ´åˆã®ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆé †
const TONE_ORDER = ["ä¸å¯§", "æ™®é€š", "ãµã–ã‘ãŸ"];

function pick(arr) {
  return arr[Math.floor(Math.random() * arr.length)];
}

function getTonesFor(cat, pur) {
  const node = DATA?.[cat]?.[pur];
  if (!node) return TONE_ORDER;
  const tones = Object.keys(node);
  // æ—¢å®šã®é †ã§ä¸¦ã¹ã€æœªçŸ¥ã¯æœ«å°¾ã«
  const sorted = [
    ...TONE_ORDER.filter(t => tones.includes(t)),
    ...tones.filter(t => !TONE_ORDER.includes(t))
  ];
  return sorted.length ? sorted : TONE_ORDER;
}

function populateCategories() {
  elCategory.innerHTML = "";
  Object.keys(DATA).forEach((cat) => {
    const opt = document.createElement("option");
    opt.value = cat;
    opt.textContent = cat;
    elCategory.appendChild(opt);
  });
}

function populatePurposes() {
  const cat = elCategory.value;
  elPurpose.innerHTML = "";
  Object.keys(DATA[cat]).forEach((pur) => {
    const opt = document.createElement("option");
    opt.value = pur;
    opt.textContent = pur;
    elPurpose.appendChild(opt);
  });
}

function populateTones() {
  const cat = elCategory.value;
  const pur = elPurpose.value;
  const tones = getTonesFor(cat, pur);

  const current = elTone.value;
  elTone.innerHTML = "";
  tones.forEach((t) => {
    const opt = document.createElement("option");
    opt.value = t;
    opt.textContent = t;
    elTone.appendChild(opt);
  });

  // å‰ã®é¸æŠãŒã‚ã‚Œã°ç¶­æŒã€ãªã‘ã‚Œã°ã€Œæ™®é€šã€å„ªå…ˆ
  if (tones.includes(current)) elTone.value = current;
  else if (tones.includes("æ™®é€š")) elTone.value = "æ™®é€š";
}

function buildText() {
  const cat = elCategory.value;
  const pur = elPurpose.value;
  const tone = elTone.value;

  const node = DATA?.[cat]?.[pur]?.[tone];
  if (!node) return "ãƒ†ãƒ³ãƒ—ãƒ¬ãŒã¾ã ã‚ã‚Šã¾ã›ã‚“ã€‚";

  const { intro = [], reason = [], ending = [] } = node;

  const i = intro.length  ? pick(intro)  : "";
  const r = reason.length ? pick(reason) : "";
  const e = ending.length ? pick(ending) : "";

  let text = [i, r, e].filter(Boolean).join("\n");

  for (let k = 0; k < 5 && text === lastText; k++) {
    const i2 = intro.length  ? pick(intro)  : i;
    const r2 = reason.length ? pick(reason) : r;
    const e2 = ending.length ? pick(ending) : e;
    text = [i2, r2, e2].filter(Boolean).join("\n");
  }

  lastText = text;
  return text;
}

function generate() {
  elOutput.value = buildText();
}

// ã‚¤ãƒ™ãƒ³ãƒˆ
elCategory.addEventListener("change", () => {
  populatePurposes();
  populateTones();
  generate();
});

elPurpose.addEventListener("change", () => {
  populateTones();
  generate();
});

elTone.addEventListener("change", generate);
btnReload.addEventListener("click", generate);

btnCopy.addEventListener("click", async () => {
  try {
    await navigator.clipboard.writeText(elOutput.value);
    const prev = btnCopy.textContent;
    btnCopy.textContent = "ã‚³ãƒ”ãƒ¼ã—ã¾ã—ãŸ";
    setTimeout(() => (btnCopy.textContent = prev), 900);
  } catch {
    alert("ã‚³ãƒ”ãƒ¼ã«å¤±æ•—ã—ã¾ã—ãŸã€‚æ‰‹å‹•ã§é¸æŠã—ã¦ã‚³ãƒ”ãƒ¼ã—ã¦ãã ã•ã„ã€‚");
  }
});

// åˆæœŸåŒ–
populateCategories();
populatePurposes();
populateTones();
generate();
</script>
</body>
</html>
